# Amazon S3 Storage Class Transitions & Lifecycle Rules

## Storage Class Transitions

Amazon S3 allows you to move objects between different storage classes to optimize cost and performance.  

Objects can transition through the following paths:

- **Standard → Standard-IA → Intelligent-Tiering → One-Zone-IA**
- **One-Zone-IA → Glacier Flexible Retrieval → Glacier Deep Archive**

All permutations are shown in the AWS S3 storage class transition diagram.

### Best Practices
- If objects will be **infrequently accessed**, move them to **Standard-IA**.
- If objects will be **archived**, move them into the **Glacier tiers** (Flexible Retrieval or Deep Archive).

---

## Lifecycle Rules

Lifecycle rules allow you to **automate transitions** and **object expirations**.

A lifecycle rule consists of:

1. **Transition actions**  
   - Example: Move to **Standard-IA** 60 days after creation.  
   - Example: Move to **Glacier** after 6 months.

2. **Expiration actions**  
   - Example: Delete access log files after **365 days**.  
   - Example: Delete old object versions (if versioning is enabled).  
   - Example: Delete incomplete multipart uploads after **14 days**.

3. **Scoping options**  
   - Apply rules to an **entire bucket**.  
   - Apply rules to a **specific prefix** (e.g., `/images/` vs `/thumbnails/`).  
   - Apply rules to objects with **specific tags** (e.g., `department=finance`).

---

## Example Scenarios

### Scenario 1: Thumbnails vs Source Images
- **Source images**:
  - Store in **Standard** for the first 60 days.
  - Transition to **Glacier** after 60 days (users can wait up to 6 hours).
- **Thumbnails**:
  - Store in **One-Zone-IA** (cheap, infrequently accessed, easily recreated).
  - **Expire after 60 days** using lifecycle rules.  
  - Differentiate using prefixes (e.g., `/source/` vs `/thumbnails/`).

---

### Scenario 2: Recovering Deleted Objects
- Company rule: Deleted objects must be recoverable:
  - **Immediately for 30 days**.
  - **Within 48 hours for up to 365 days**.
- Solution:
  - Enable **S3 Versioning**.
  - Transition **non-current versions** to **Standard-IA**.
  - Transition older non-current versions to **Glacier Deep Archive**.

---

## Determining Optimal Transition Timing

Use **Amazon S3 Analytics** to determine the best number of days before transitioning objects.

- Provides recommendations for **Standard → Standard-IA** transitions.
- **Does not support** One-Zone-IA or Glacier classes.
- Generates a **daily CSV report** with usage statistics and recommendations.
- First results are available **within 24–48 hours**.

This helps you fine-tune lifecycle policies for cost optimization.

---

## Summary

- **Transition actions** move objects between storage classes.  
- **Expiration actions** delete objects or incomplete uploads.  
- Lifecycle rules can apply to **buckets, prefixes, or tagged objects**.  
- **S3 Analytics** helps optimize lifecycle transitions.

---
