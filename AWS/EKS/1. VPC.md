# AWS VPC Setup with Public Subnets (AWS CLI)

This document explains how to create and configure a **VPC with public subnets** using the AWS CLI.  
Each command includes an explanation for clarity.  

---

## 1. Create a VPC

```bash
aws ec2 create-vpc \
  --cidr-block 10.0.0.0/16 \
  --region us-east-1 \
  --query "Vpc.VpcId" \
  --output text
```
## Explanation:

- Creates a new VPC with CIDR block 10.0.0.0/16.

- Restricts the VPC to the us-east-1 region.

- The --query and --output text flags return only the VPC ID.

### Example Output:

```
vpc-022d831ccf7b2ca17
```
## 2. Enable DNS Support and Hostnames

```
aws ec2 modify-vpc-attribute \
  --vpc-id vpc-022d831ccf7b2ca17 \
  --region us-east-1 \
  --enable-dns-support

aws ec2 modify-vpc-attribute \
  --vpc-id vpc-022d831ccf7b2ca17 \
  --region us-east-1 \
  --enable-dns-hostnames

```


## Explanation:

- Enables DNS resolution and assigns hostnames to instances in the VPC.

- Required for instances to be reachable via domain names.

## 3. Create and Attach an Internet Gateway

```   
aws ec2 create-internet-gateway \
  --region us-east-1 \
  --query "InternetGateway.InternetGatewayId" \
  --output text
```

## Example Output:

```
igw-0f608453bf818949a
```

## Attach the Internet Gateway to the VPC:
```
aws ec2 attach-internet-gateway \
  --vpc-id vpc-022d831ccf7b2ca17 \
  --region us-east-1 \
  --internet-gateway-id igw-0f608453bf818949a

```

## 4. Create a Route Table
```
aws ec2 create-route-table \
  --vpc-id vpc-022d831ccf7b2ca17 \
  --region us-east-1 \
  --query "RouteTable.RouteTableId" \
  --output text
```



## Example Output:

```
rtb-0f3e7f7d176bc9a6
```

- Add a default route (0.0.0.0/0) to the Internet Gateway:
```
aws ec2 create-route \
  --route-table-id rtb-0f3e7f7d176bc9a60 \
  --destination-cidr-block 0.0.0.0/0 \
  --region us-east-1 \
  --gateway-id igw-0f608453bf818949a
```


## 5. Create Public Subnets

- Subnet in us-east-1a
```
aws ec2 create-subnet \
  --vpc-id vpc-022d831ccf7b2ca17 \
  --cidr-block 10.0.1.0/24 \
  --availability-zone us-east-1a \
  --region us-east-1 \
  --query "Subnet.SubnetId" \
  --output text
```

- Subnet in us-east-1b

```
  aws ec2 create-subnet \
  --vpc-id vpc-022d831ccf7b2ca17 \
  --cidr-block 10.0.2.0/24 \
  --availability-zone us-east-1b \
  --region us-east-1 \
  --query "Subnet.SubnetId" \
  --output text
```
## 6. Associate Subnets with Route Table

```
aws ec2 associate-route-table \
  --subnet-id subnet-0266f70960b3da6d5 \
  --region us-east-1 \
  --route-table-id rtb-0f3e7f7d176bc9a60

aws ec2 associate-route-table \
  --subnet-id subnet-099f3c955f9b6f9c0 \
  --region us-east-1 \
  --route-table-id rtb-0f3e7f7d176bc9a60

```

## Explanation:

- Associates both subnets with the route table, enabling them to use the Internet Gateway.

## 7. Enable Auto-Assign Public IP on Subnets

```
aws ec2 modify-subnet-attribute \
  --subnet-id subnet-0266f70960b3da6d5 \
  --map-public-ip-on-launch \
  --region us-east-1

aws ec2 modify-subnet-attribute \
  --subnet-id subnet-099f3c955f9b6f9c0 \
  --map-public-ip-on-launch \
  --region us-east-1
```
## 8. Create-security-group

```
aws ec2 create-security-group \
  --group-name eks-cluster-sg \
  --description "EKS Cluster Security Group" \
  --vpc-id vpc-022d831ccf7b2ca17 \
  --region us-east-1
```

## Explanation:

- Ensures that new EC2 instances launched in these subnets automatically receive a public IP.

## Summary

- VPC ID: vpc-022d831ccf7b2ca17

- Internet Gateway ID: igw-0f608453bf818949a

- Route Table ID: rtb-0f3e7f7d176bc9a60

- Public Subnets:

    -  subnet-0266f70960b3da6d5 (us-east-1a)

    -  subnet-099f3c955f9b6f9c0 (us-east-1b)
 
- create-security-group: sg-0e68eea838aa7ebf3
